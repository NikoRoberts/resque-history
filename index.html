<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Resque-history : Show history of recently executed resque jobs" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <script src="http://coinwidget.com/widget/coin.js"></script>
    <title>Resque-history</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/ilyakatz/resque-history">View on GitHub</a>

          <h1 id="project_title">Resque-history</h1>
          <h2 id="project_tagline">Show history of recently executed resque jobs</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/ilyakatz/resque-history/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/ilyakatz/resque-history/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="resque-history" class="anchor" href="#resque-history"><span class="octicon octicon-link"></span></a>Resque History</h1>

<p><a href="http://travis-ci.org/#!/ilyakatz/resque-history"><img src="https://secure.travis-ci.org/ilyakatz/resque-history.png?branch=master" alt="alt build status"></a><a href="https://gemnasium.com/ilyakatz/resque-history"><img src="https://gemnasium.com/ilyakatz/resque-history.png?travis" alt="Dependency Status"></a>
<a href="https://codeclimate.com/github/ilyakatz/resque-history"><img src="https://codeclimate.com/github/ilyakatz/resque-history.png" alt="Code Climate"></a>
<a href="http://badge.fury.io/rb/resque-history"><img src="https://badge.fury.io/rb/resque-history.png" alt="Gem Version"></a></p>
<script>
CoinWidgetCom.go({
  wallet_address: "1NuWg2DBv5Kyi8FpcLvKHNteqnPu6XqUk8"
  , currency: "bitcoin"
  , counter: "count"
  , alignment: "bl"
  , qrcode: true
  , auto_show: false
  , lbl_button: "Donate"
  , lbl_address: "My Bitcoin Address:"
  , lbl_count: "donations"
  , lbl_amount: "BTC"
});
</script>




<p>A <a href="http://github.com/defunkt/resque">Resque</a> plugin. Requires Resque</p>

<p>resque-history adds functionality record recently history of job executions</p>

<h2>
<a name="usage--examples" class="anchor" href="#usage--examples"><span class="octicon octicon-link"></span></a>Usage / Examples</h2>

<h3>
<a name="single-job-instance" class="anchor" href="#single-job-instance"><span class="octicon octicon-link"></span></a>Single Job Instance</h3>

<div class="highlight highlight-ruby"><pre>    <span class="nb">require</span> <span class="s1">'resque-history'</span>

    <span class="k">class</span> <span class="nc">UpdateNetworkGraph</span>
      <span class="kp">extend</span> <span class="no">Resque</span><span class="o">::</span><span class="no">Plugins</span><span class="o">::</span><span class="no">History</span>
      <span class="vi">@queue</span> <span class="o">=</span> <span class="ss">:network_graph</span>

      <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="n">some_id</span><span class="p">)</span>
        <span class="n">do_stuff</span><span class="p">(</span><span class="n">some_id</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
</pre></div>

<h3>
<a name="job-history" class="anchor" href="#job-history"><span class="octicon octicon-link"></span></a>Job History</h3>

<p>By default resque-history stores 500 history items on redis,
but if you want to store less items, assign @max_history in the job class.</p>

<div class="highlight highlight-ruby"><pre>    <span class="nb">require</span> <span class="s1">'resque-history'</span>

    <span class="k">class</span> <span class="nc">UpdateNetworkGraph</span>
      <span class="kp">extend</span> <span class="no">Resque</span><span class="o">::</span><span class="no">Plugins</span><span class="o">::</span><span class="no">History</span>
      <span class="vi">@queue</span> <span class="o">=</span> <span class="ss">:network_graph</span>
      <span class="vi">@max_history</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># max number of histories to be kept</span>

      <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">perform</span><span class="p">(</span><span class="n">some_id</span><span class="p">)</span>
        <span class="n">do_stuff</span><span class="p">(</span><span class="n">some_id</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
</pre></div>

<h3>
<a name="3rd-party-classes" class="anchor" href="#3rd-party-classes"><span class="octicon octicon-link"></span></a>3rd Party classes</h3>

<p>If you want to use resque history with 3rd party resque jobs,
extended the classes that you want to be recorded in history</p>

<div class="highlight highlight-ruby"><pre><span class="o">[</span>
    <span class="no">CarrierWave</span><span class="o">::</span><span class="no">Workers</span><span class="o">::</span><span class="no">ProcessAsset</span><span class="p">,</span>
    <span class="no">CarrierWave</span><span class="o">::</span><span class="no">Workers</span><span class="o">::</span><span class="no">StoreAsset</span><span class="p">,</span>
    <span class="no">ActionMailer</span><span class="o">::</span><span class="no">DeliveryMethods</span>
<span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">klazz</span><span class="o">|</span>
  <span class="n">klazz</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
    <span class="kp">extend</span> <span class="no">Resque</span><span class="o">::</span><span class="no">Plugins</span><span class="o">::</span><span class="no">History</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<h2>
<a name="resque-web-integration" class="anchor" href="#resque-web-integration"><span class="octicon octicon-link"></span></a>Resque-Web integration</h2>

<p>'History' tab in resque web GUI</p>

<p><img src="https://img.skitch.com/20120510-x4egbeih39bb2xe82c2mtapmp9.jpg" alt="Resque History GUI"></p>

<h1>
<a name="install" class="anchor" href="#install"><span class="octicon octicon-link"></span></a>Install</h1>

<p>Add to your Gemfile</p>

<pre><code>$ gem "resque-history"
</code></pre>

<p>Add to routes.rb file</p>

<pre><code>require 'resque-history/server'
</code></pre>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Resque-history maintained by <a href="https://github.com/ilyakatz">ilyakatz</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>



  </body>
</html>


